import{c,a as e,o as m,d as ee,x as te,r as p,p as _,y as oe,f as se,j as l,h as P,b as d,t as r,I as re,g as i,q as S,i as ne,v as g,F as k,z as V,J as le,w as U,n as de,A as ae}from"./index-D0gnmK0b.js";import{r as j,a as ie}from"./PlusIcon-Dl4LIrTD.js";import{r as A}from"./ClockIcon-C1iuYBt7.js";import{r as ue}from"./CheckCircleIcon-DIOsNbTF.js";import{r as ce,a as me}from"./MagnifyingGlassIcon-xmMHmY14.js";import{r as ge}from"./CalendarIcon-DLnXeCIc.js";import{r as I}from"./TrashIcon-CaummfL_.js";function $(q,M){return m(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"})])}const pe={class:"flex flex-col"},fe={class:"bg-gradient-to-r from-green-600 to-green-700 text-white rounded-2xl p-8 mb-6"},be={class:"flex justify-between items-center"},xe={class:"mb-8"},ve={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},ye={class:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100"},we={class:"h-12 w-12 rounded-2xl bg-green-100 text-green-600 flex items-center justify-center mb-4"},he={class:"text-3xl font-bold text-gray-900"},_e={class:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100"},Pe={class:"h-12 w-12 rounded-2xl bg-green-100 text-green-600 flex items-center justify-center mb-4"},ke={class:"text-3xl font-bold text-gray-900"},Ve={class:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100"},Ce={class:"h-12 w-12 rounded-2xl bg-green-100 text-green-600 flex items-center justify-center mb-4"},Ee={class:"text-3xl font-bold text-gray-900"},Se={class:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100"},Me={class:"h-12 w-12 rounded-2xl bg-green-100 text-green-600 flex items-center justify-center mb-4"},De={class:"text-3xl font-bold text-gray-900"},Te={class:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100 mb-6"},Ue={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},je={class:"relative"},Ae={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"},Ie={class:"flex justify-between items-start mb-4"},$e={class:"text-xl font-bold text-gray-900"},qe={class:"text-gray-600"},Ne={class:"flex flex-col mb-4"},Fe={class:"flex items-center text-sm text-gray-600 mb-2"},Re={class:"flex items-center text-sm text-gray-600 mb-2"},ze={class:"flex items-center text-sm text-gray-600 mb-2"},Le={class:"flex items-center text-sm text-gray-600"},Be={class:"mb-4"},He={class:"font-semibold text-gray-900 mb-2"},Oe={class:"flex flex-col"},Ge={class:"text-gray-900"},Je={class:"text-gray-600"},Qe={class:"mb-4 p-4 bg-gray-50 rounded-lg"},Xe={class:"flex justify-between text-sm"},Ke={class:"font-semibold text-gray-900"},We={class:"flex gap-2"},Ye=["onClick"],Ze=["onClick"],et={class:"flex justify-between items-center p-6 border-b border-gray-200"},tt={class:"text-2xl font-bold text-gray-900"},ot={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},st={class:"mb-6"},rt={class:"flex flex-col"},nt=["onUpdate:modelValue"],lt=["value"],dt=["onUpdate:modelValue"],at=["onUpdate:modelValue"],it=["onClick"],ut={class:"flex justify-end gap-4 pt-6 border-t border-gray-200"},ct={type:"submit",class:"bg-white text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors flex items-center"},mt=ee({__name:"ProductionView",setup(q){const{getProductions:M,addProduction:N,updateProduction:F,deleteProduction:R,getArticles:z}=te(),f=p([]),x=p([]),C=p(!1),b=p(null),v=p(""),y=p(""),w=p(""),n=p({date:new Date().toISOString().split("T")[0],lotId:"",statut:"en_attente",articlesProduits:[{nom:"",quantiteProduite:0,unite:""}],tempsEffectif:0,rendement:0,coutProduction:0}),L=_(()=>{let o=f.value;if(v.value&&(o=o.filter(t=>t.statut===v.value)),y.value&&(o=o.filter(t=>t.date===y.value)),w.value){const t=w.value.toLowerCase();o=o.filter(s=>s.lotId.toLowerCase().includes(t)||s.articlesProduits.some(u=>u.nom.toLowerCase().includes(t)))}return o.sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime())}),B=_(()=>f.value.filter(o=>o.statut==="en_attente").length),H=_(()=>f.value.filter(o=>o.statut==="en_cours").length),O=_(()=>f.value.filter(o=>o.statut==="termine").length),E=async()=>{try{console.log("üîç [ProductionView] Chargement des productions"),f.value=await M(),console.log("‚úÖ [ProductionView] Productions charg√©es:",f.value.length)}catch(o){console.error("‚ùå [ProductionView] Erreur lors du chargement des productions:",o),alert("Erreur lors du chargement des productions")}},G=async()=>{try{console.log("üîç [ProductionView] Chargement des articles");const o=await z();x.value=o.map(t=>({nom:t.nom,stock:t.stock,unite:t.unite,prix:t.prix})),console.log("‚úÖ [ProductionView] Articles charg√©s:",x.value.length)}catch(o){console.error("‚ùå [ProductionView] Erreur lors du chargement des articles:",o),x.value=[]}},D=o=>{o?(b.value=o,n.value={date:o.date,lotId:o.lotId,statut:o.statut,articlesProduits:o.articlesProduits,tempsEffectif:o.tempsEffectif||0,rendement:o.rendement||0,coutProduction:o.coutProduction||0}):(b.value=null,n.value={date:new Date().toISOString().split("T")[0],lotId:"",statut:"en_attente",articlesProduits:[{nom:"",quantiteProduite:0,unite:""}],tempsEffectif:0,rendement:0,coutProduction:0}),C.value=!0},h=()=>{C.value=!1,b.value=null},J=async()=>{try{console.log("üîç [ProductionView] Sauvegarde de la production");const o={...n.value};b.value?(await F(b.value.id,o),console.log("‚úÖ [ProductionView] Production mise √† jour")):(await N(o),console.log("‚úÖ [ProductionView] Production cr√©√©e")),await E(),h(),alert("Production enregistr√©e avec succ√®s!")}catch(o){console.error("‚ùå [ProductionView] Erreur lors de la sauvegarde:",o),alert("Erreur lors de la sauvegarde de la production")}},Q=async o=>{if(confirm("√ätes-vous s√ªr de vouloir supprimer cette production ?"))try{console.log("üîç [ProductionView] Suppression de la production:",o),await R(o),await E(),console.log("‚úÖ [ProductionView] Production supprim√©e")}catch(t){console.error("‚ùå [ProductionView] Erreur lors de la suppression:",t),alert("Erreur lors de la suppression de la production")}},X=()=>{n.value.articlesProduits.push({nom:"",quantiteProduite:0,unite:""})},K=o=>{n.value.articlesProduits.splice(o,1)},W=o=>({en_attente:"bg-yellow-100 text-yellow-800",en_cours:"bg-blue-100 text-blue-800",termine:"bg-green-100 text-green-800",annule:"bg-red-100 text-red-800"})[o]||"bg-yellow-100 text-yellow-800",Y=o=>({en_attente:"En attente",en_cours:"En cours",termine:"Termin√©",annule:"Annul√©"})[o]||o,T=o=>new Date(o).toLocaleDateString("fr-FR"),Z=o=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(o);return oe(async()=>{await E(),await G()}),(o,t)=>(m(),c("div",pe,[e("div",fe,[e("div",be,[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-3xl font-bold mb-2"},"Gestion de la Production"),e("p",{class:"text-green-100 text-lg"},"Planifiez et suivez vos productions")],-1)),e("div",null,[e("button",{onClick:t[0]||(t[0]=s=>D()),class:"bg-white text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors flex items-center"},[l(d(j),{class:"h-5 w-5 mr-2"}),t[11]||(t[11]=P(" Nouvelle Production ",-1))])])])]),e("div",xe,[e("div",ve,[e("div",ye,[e("div",we,[l(d($),{class:"h-8 w-8"})]),e("div",null,[t[13]||(t[13]=e("h3",{class:"text-sm font-medium text-gray-600 mb-2"},"Total Productions",-1)),e("p",he,r(f.value.length),1)])]),e("div",_e,[e("div",Pe,[l(d(A),{class:"h-8 w-8"})]),e("div",null,[t[14]||(t[14]=e("h3",{class:"text-sm font-medium text-gray-600 mb-2"},"En Attente",-1)),e("p",ke,r(B.value),1)])]),e("div",Ve,[e("div",Ce,[l(d(re),{class:"h-8 w-8"})]),e("div",null,[t[15]||(t[15]=e("h3",{class:"text-sm font-medium text-gray-600 mb-2"},"En Cours",-1)),e("p",Ee,r(H.value),1)])]),e("div",Se,[e("div",Me,[l(d(ue),{class:"h-8 w-8"})]),e("div",null,[t[16]||(t[16]=e("h3",{class:"text-sm font-medium text-gray-600 mb-2"},"Termin√©es",-1)),e("p",De,r(O.value),1)])])])]),e("div",Te,[e("div",Ue,[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),i(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},[...t[17]||(t[17]=[ne('<option value="" data-v-d3655100>Tous les statuts</option><option value="en_attente" data-v-d3655100>En attente</option><option value="en_cours" data-v-d3655100>En cours</option><option value="termine" data-v-d3655100>Termin√©</option><option value="annule" data-v-d3655100>Annul√©</option>',5)])],512),[[S,v.value]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Recherche",-1)),e("div",je,[l(d(ce),{class:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>w.value=s),type:"text",placeholder:"Rechercher par lot, article...",class:"w-full pl-10 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,512),[[g,w.value]])])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date",-1)),i(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>y.value=s),type:"date",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,512),[[g,y.value]])])])]),e("div",Ae,[(m(!0),c(k,null,V(L.value,s=>(m(),c("div",{key:s.id,class:"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-6 border border-gray-100"},[e("div",Ie,[e("div",null,[e("h3",$e,r(s.lotId),1),e("p",qe,r(T(s.date)),1)]),e("div",{class:de(["px-3 py-1 rounded-full text-sm font-medium",W(s.statut)])},r(Y(s.statut)),3)]),e("div",Ne,[e("div",Fe,[l(d(ge),{class:"h-4 w-4 mr-2"}),e("span",null,r(T(s.date)),1)]),e("div",Re,[l(d(A),{class:"h-4 w-4 mr-2"}),e("span",null,r(s.tempsEffectif||0)+"h",1)]),e("div",ze,[l(d($),{class:"h-4 w-4 mr-2"}),e("span",null,r(s.articlesProduits.length)+" articles",1)]),e("div",Le,[l(d(me),{class:"h-4 w-4 mr-2"}),e("span",null,r(Z(s.coutProduction||0)),1)])]),e("div",Be,[e("h4",He,"Articles produits ("+r(s.articlesProduits.length)+")",1),e("div",Oe,[(m(!0),c(k,null,V(s.articlesProduits,u=>(m(),c("div",{key:u.nom,class:"flex justify-between text-sm mb-1"},[e("span",Ge,r(u.nom),1),e("span",Je,r(u.quantiteProduite)+" "+r(u.unite),1)]))),128))])]),e("div",Qe,[e("div",Xe,[t[21]||(t[21]=e("span",{class:"text-gray-600"},"Rendement:",-1)),e("span",Ke,r(s.rendement||0)+"%",1)])]),e("div",We,[e("button",{onClick:u=>D(s),class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center bg-gray-200 text-gray-800 hover:bg-gray-300"},[l(d(ie),{class:"h-4 w-4 mr-2"}),t[22]||(t[22]=P(" Modifier ",-1))],8,Ye),e("button",{onClick:u=>Q(s.id),class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center bg-red-600 text-white hover:bg-red-700"},[l(d(I),{class:"h-4 w-4 mr-2"}),t[23]||(t[23]=P(" Supprimer ",-1))],8,Ze)])]))),128))]),C.value?(m(),c("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:h},[e("div",{class:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:t[10]||(t[10]=U(()=>{},["stop"]))},[e("div",et,[e("h2",tt,r(b.value?"Modifier la production":"Nouvelle production"),1),e("button",{onClick:h,class:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},[l(d(le),{class:"h-6 w-6"})])]),e("form",{onSubmit:U(J,["prevent"]),class:"p-6"},[e("div",ot,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date",-1)),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.value.date=s),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,512),[[g,n.value.date]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ID du lot",-1)),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n.value.lotId=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,512),[[g,n.value.lotId]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),i(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>n.value.statut=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},[...t[26]||(t[26]=[e("option",{value:"en_attente"},"En attente",-1),e("option",{value:"en_cours"},"En cours",-1),e("option",{value:"termine"},"Termin√©",-1),e("option",{value:"annule"},"Annul√©",-1)])],512),[[S,n.value.statut]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Temps effectif (heures)",-1)),i(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>n.value.tempsEffectif=s),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,512),[[g,n.value.tempsEffectif,void 0,{number:!0}]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rendement (%)",-1)),i(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>n.value.rendement=s),type:"number",min:"0",max:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,512),[[g,n.value.rendement,void 0,{number:!0}]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Co√ªt de production",-1)),i(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>n.value.coutProduction=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,512),[[g,n.value.coutProduction,void 0,{number:!0}]])])]),e("div",st,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Articles produits",-1)),e("div",rt,[(m(!0),c(k,null,V(n.value.articlesProduits,(s,u)=>(m(),c("div",{key:u,class:"flex gap-2 items-center mb-3"},[i(e("select",{"onUpdate:modelValue":a=>s.nom=a,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},[t[31]||(t[31]=e("option",{value:""},"S√©lectionner un article",-1)),(m(!0),c(k,null,V(x.value,a=>(m(),c("option",{key:a.nom,value:a.nom},r(a.nom)+" (Stock: "+r(a.stock)+" "+r(a.unite)+") ",9,lt))),128))],8,nt),[[S,s.nom]]),i(e("input",{"onUpdate:modelValue":a=>s.quantiteProduite=a,type:"number",placeholder:"Quantit√© produite",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,8,dt),[[g,s.quantiteProduite,void 0,{number:!0}]]),i(e("input",{"onUpdate:modelValue":a=>s.unite=a,placeholder:"Unit√©",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},null,8,at),[[g,s.unite]]),e("button",{type:"button",onClick:a=>K(u),class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2 bg-red-600 text-white hover:bg-red-700"},[l(d(I),{class:"h-4 w-4"})],8,it)]))),128)),e("button",{type:"button",onClick:X,class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2 bg-gray-200 text-gray-800 hover:bg-gray-300"},[l(d(j),{class:"h-4 w-4"}),t[32]||(t[32]=P(" Ajouter un article ",-1))])])]),e("div",ut,[e("button",{type:"button",onClick:h,class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2 bg-gray-200 text-gray-800 hover:bg-gray-300"}," Annuler "),e("button",ct,r(b.value?"Modifier":"Cr√©er"),1)])],32)])])):se("",!0)]))}}),wt=ae(mt,[["__scopeId","data-v-d3655100"]]);export{wt as default};
