import{d as at,u as rt,z as lt,a as x,l as c,A as it,c as l,e as t,s as i,f as o,B as $,j as g,D as _,h as u,E as dt,t as r,F as D,G as v,H as L,I as M,J as B,n as F,K as N,L as R,M as ct,N as ut,o as a,_ as mt}from"./main-Ddag5VAa.js";import{r as I}from"./CurrencyDollarIcon-CPQdNqjW.js";const gt={class:"dashboard-container min-h-screen bg-gray-50"},xt={class:"header-content bg-white border-b border-gray-200 shadow-sm"},ht={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},vt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},ft={class:"flex items-center mb-4 sm:mb-0"},_t={class:"h-12 w-12 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 flex items-center justify-center shadow-lg mr-4"},wt={class:"flex space-x-3"},yt=["disabled"],bt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},pt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Dt={key:0,class:"stat-card bg-white rounded-xl shadow-lg overflow-hidden"},Lt={class:"stat-content p-6"},kt={class:"flex items-center"},jt={class:"h-12 w-12 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center shadow-lg"},Vt={class:"ml-4"},St={class:"stat-value text-2xl font-bold text-gray-900"},Ct={key:1,class:"stat-card bg-white rounded-xl shadow-lg overflow-hidden"},Tt={class:"stat-content p-6"},Pt={class:"flex items-center"},At={class:"h-12 w-12 rounded-xl bg-gradient-to-r from-green-500 to-green-600 flex items-center justify-center shadow-lg"},Et={class:"ml-4"},$t={class:"stat-value text-2xl font-bold text-gray-900"},Mt={key:2,class:"stat-card bg-white rounded-xl shadow-lg overflow-hidden"},Bt={class:"stat-content p-6"},Ft={class:"flex items-center"},Nt={class:"h-12 w-12 rounded-xl bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center shadow-lg"},Rt={class:"ml-4"},It={class:"stat-value text-2xl font-bold text-gray-900"},qt={key:3,class:"stat-card bg-white rounded-xl shadow-lg overflow-hidden"},zt={class:"stat-content p-6"},Gt={class:"flex items-center"},Ot={class:"h-12 w-12 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 flex items-center justify-center shadow-lg"},Ht={class:"ml-4"},Jt={class:"stat-value text-2xl font-bold text-gray-900"},Kt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Xt={key:0,class:"bg-white rounded-xl shadow-lg p-6"},Yt={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},Qt={class:"space-y-4"},Ut={class:"flex items-center justify-between"},Wt={class:"text-sm font-semibold text-gray-900"},Zt={class:"flex items-center justify-between"},te={class:"text-sm font-semibold text-gray-900"},ee={class:"flex items-center justify-between"},se={class:"text-sm font-semibold text-gray-900"},oe={key:1,class:"bg-white rounded-xl shadow-lg p-6"},ne={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},ae={class:"space-y-4"},re={class:"flex items-center justify-between"},le={class:"text-sm font-semibold text-gray-900"},ie={class:"flex items-center justify-between"},de={class:"text-sm font-semibold text-gray-900"},ce={class:"flex items-center justify-between"},ue={class:"text-sm font-semibold text-gray-900"},me={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},ge={key:0,class:"bg-white rounded-xl shadow-lg overflow-hidden"},xe={class:"px-6 py-4 border-b border-gray-200"},he={class:"text-lg font-semibold text-gray-900 flex items-center"},ve={class:"p-6"},fe={key:0,class:"text-center py-8"},_e={key:1,class:"space-y-4"},we={class:"flex items-center"},ye={class:"h-10 w-10 rounded-full bg-gradient-to-r from-orange-500 to-orange-600 flex items-center justify-center shadow-lg mr-4"},be={class:"text-sm font-medium text-gray-900"},pe={class:"text-sm text-gray-500"},De={class:"text-right"},Le={class:"text-sm font-semibold text-green-600"},ke={key:1,class:"bg-white rounded-xl shadow-lg overflow-hidden"},je={class:"px-6 py-4 border-b border-gray-200"},Ve={class:"text-lg font-semibold text-gray-900 flex items-center"},Se={class:"p-6"},Ce={key:0,class:"text-center py-8"},Te={key:1,class:"space-y-4"},Pe={class:"flex items-center"},Ae={class:"h-10 w-10 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center shadow-lg mr-4"},Ee={class:"text-sm font-medium text-gray-900"},$e={class:"text-sm text-gray-500"},Me={class:"text-right"},Be={class:"text-sm font-semibold text-gray-900"},Fe={class:"bg-white rounded-xl shadow-lg p-6"},Ne={class:"text-lg font-semibold text-gray-900 mb-6 flex items-center"},Re={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ie={key:0,class:"text-center"},qe={class:"h-16 w-16 rounded-full bg-gradient-to-r from-orange-500 to-orange-600 flex items-center justify-center shadow-lg mx-auto mb-4"},ze={class:"text-2xl font-bold text-orange-600"},Ge={key:1,class:"text-center"},Oe={class:"h-16 w-16 rounded-full bg-gradient-to-r from-green-500 to-green-600 flex items-center justify-center shadow-lg mx-auto mb-4"},He={class:"text-2xl font-bold text-green-600"},Je={key:2,class:"text-center"},Ke={class:"h-16 w-16 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center shadow-lg mx-auto mb-4"},Xe={class:"text-2xl font-bold text-purple-600"},Ye=at({__name:"DashboardView",setup(Qe){const{getCommandes:q,getLivraisons:z,getProductions:G,getGeneralStats:O,getProductionStats:H,getDeliveryStats:J}=rt(),{permissions:d}=lt(),w=x(!1),k=x([]),m=x([]),h=x([]),K=x({}),X=x({}),Y=x({}),j=c(()=>m.value.sort((s,e)=>new Date(e.date).getTime()-new Date(s.date).getTime()).slice(0,5)),V=c(()=>h.value.sort((s,e)=>new Date(e.date).getTime()-new Date(s.date).getTime()).slice(0,5)),Q=c(()=>k.value.length),y=c(()=>m.value.length),b=c(()=>h.value.length),U=c(()=>m.value.filter(s=>s.statut==="en_cours").length),S=c(()=>m.value.filter(s=>s.statut==="livre").length),W=c(()=>h.value.filter(s=>s.statut==="en_cours").length),C=c(()=>h.value.filter(s=>s.statut==="termine").length),Z=c(()=>m.value.filter(s=>s.statut==="livre").reduce((s,e)=>s+(e.total_livraison||0),0)),tt=c(()=>{const s=new Date,e=new Date(s.getFullYear(),s.getMonth(),1);return m.value.filter(n=>{const f=new Date(n.date);return n.statut==="livre"&&f>=e}).reduce((n,f)=>n+(f.total_livraison||0),0)});it(async()=>{await T()});const T=async()=>{try{w.value=!0;const[s,e,n,f,ot,nt]=await Promise.all([q(),z(),G(),O(),H({period:"month"}),J({period:"month"})]);k.value=s,m.value=e,h.value=n,K.value=f,X.value=ot,Y.value=nt}catch(s){console.error("Erreur lors du chargement des données du dashboard:",s)}finally{w.value=!1}},et=async()=>{await T()},st=s=>new Date(s).toLocaleDateString("fr-FR"),p=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(s),P=s=>{switch(s){case"livre":case"termine":return"bg-green-100 text-green-800";case"en_cours":return"bg-yellow-100 text-yellow-800";case"en_attente":return"bg-blue-100 text-blue-800";case"annule":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},A=s=>{switch(s){case"livre":case"termine":return ut;case"en_cours":return _;case"en_attente":return _;case"annule":return ct;default:return _}},E=s=>{switch(s){case"livre":return"Livré";case"termine":return"Terminé";case"en_cours":return"En cours";case"en_attente":return"En attente";case"annule":return"Annulé";default:return s}};return(s,e)=>(a(),l("div",gt,[t("div",xt,[t("div",ht,[t("div",vt,[t("div",ft,[t("div",_t,[i(o($),{class:"h-6 w-6 text-white"})]),e[0]||(e[0]=t("div",null,[t("h1",{class:"page-title text-2xl font-bold text-gray-900"},"Dashboard"),t("p",{class:"text-sm text-gray-600"},"Vue d'ensemble de votre activité")],-1))]),t("div",wt,[t("button",{onClick:et,disabled:w.value,class:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-medium rounded-xl shadow-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50"},[i(o(_),{class:"h-5 w-5 mr-2"}),e[1]||(e[1]=g(" Actualiser ",-1))],8,yt)])])])]),t("div",bt,[t("div",pt,[o(d).canViewCommandes?(a(),l("div",Dt,[t("div",Lt,[t("div",kt,[t("div",jt,[i(o(dt),{class:"h-6 w-6 text-white"})]),t("div",Vt,[e[2]||(e[2]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Commandes",-1)),t("p",St,r(Q.value),1)])])])])):u("",!0),o(d).canViewLivraisons?(a(),l("div",Ct,[t("div",Tt,[t("div",Pt,[t("div",At,[i(o(D),{class:"h-6 w-6 text-white"})]),t("div",Et,[e[3]||(e[3]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Livraisons",-1)),t("p",$t,r(y.value),1)])])])])):u("",!0),o(d).canViewProduction?(a(),l("div",Mt,[t("div",Bt,[t("div",Ft,[t("div",Nt,[i(o(v),{class:"h-6 w-6 text-white"})]),t("div",Rt,[e[4]||(e[4]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Productions",-1)),t("p",It,r(b.value),1)])])])])):u("",!0),o(d).canViewLivraisons?(a(),l("div",qt,[t("div",zt,[t("div",Gt,[t("div",Ot,[i(o(I),{class:"h-6 w-6 text-white"})]),t("div",Ht,[e[5]||(e[5]=t("p",{class:"text-sm font-medium text-gray-600"},"CA Total",-1)),t("p",Jt,r(p(Z.value)),1)])])])])):u("",!0)]),t("div",Kt,[o(d).canViewLivraisons?(a(),l("div",Xt,[t("h3",Yt,[i(o(D),{class:"h-5 w-5 mr-2 text-green-600"}),e[6]||(e[6]=g(" Statut des Livraisons ",-1))]),t("div",Qt,[t("div",Ut,[e[7]||(e[7]=t("div",{class:"flex items-center"},[t("div",{class:"h-3 w-3 rounded-full bg-green-500 mr-3"}),t("span",{class:"text-sm text-gray-600"},"Livrées")],-1)),t("span",Wt,r(S.value),1)]),t("div",Zt,[e[8]||(e[8]=t("div",{class:"flex items-center"},[t("div",{class:"h-3 w-3 rounded-full bg-yellow-500 mr-3"}),t("span",{class:"text-sm text-gray-600"},"En cours")],-1)),t("span",te,r(U.value),1)]),t("div",ee,[e[9]||(e[9]=t("div",{class:"flex items-center"},[t("div",{class:"h-3 w-3 rounded-full bg-blue-500 mr-3"}),t("span",{class:"text-sm text-gray-600"},"En attente")],-1)),t("span",se,r(m.value.filter(n=>n.statut==="en_attente").length),1)])])])):u("",!0),o(d).canViewProduction?(a(),l("div",oe,[t("h3",ne,[i(o(v),{class:"h-5 w-5 mr-2 text-purple-600"}),e[10]||(e[10]=g(" Statut des Productions ",-1))]),t("div",ae,[t("div",re,[e[11]||(e[11]=t("div",{class:"flex items-center"},[t("div",{class:"h-3 w-3 rounded-full bg-green-500 mr-3"}),t("span",{class:"text-sm text-gray-600"},"Terminées")],-1)),t("span",le,r(C.value),1)]),t("div",ie,[e[12]||(e[12]=t("div",{class:"flex items-center"},[t("div",{class:"h-3 w-3 rounded-full bg-yellow-500 mr-3"}),t("span",{class:"text-sm text-gray-600"},"En cours")],-1)),t("span",de,r(W.value),1)]),t("div",ce,[e[13]||(e[13]=t("div",{class:"flex items-center"},[t("div",{class:"h-3 w-3 rounded-full bg-blue-500 mr-3"}),t("span",{class:"text-sm text-gray-600"},"En attente")],-1)),t("span",ue,r(h.value.filter(n=>n.statut==="en_attente").length),1)])])])):u("",!0)]),t("div",me,[o(d).canViewLivraisons?(a(),l("div",ge,[t("div",xe,[t("h3",he,[i(o(L),{class:"h-5 w-5 mr-2 text-orange-600"}),e[14]||(e[14]=g(" Bons de Livraison Récents ",-1))])]),t("div",ve,[j.value.length===0?(a(),l("div",fe,[i(o(L),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e[15]||(e[15]=t("p",{class:"text-gray-600"},"Aucune livraison récente",-1))])):(a(),l("div",_e,[(a(!0),l(M,null,B(j.value,n=>(a(),l("div",{key:n.id,class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[t("div",we,[t("div",ye,[i(o(L),{class:"h-5 w-5 text-white"})]),t("div",null,[t("div",be,r(n.numero_bl||`BL-${n.id}`),1),t("div",pe,r(n.client||"Client non défini"),1)])]),t("div",De,[t("div",Le,r(p(n.total_livraison||0)),1),t("span",{class:F(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",P(n.statut)])},[(a(),N(R(A(n.statut)),{class:"h-3 w-3 mr-1"})),g(" "+r(E(n.statut)),1)],2)])]))),128))]))])])):u("",!0),o(d).canViewProduction?(a(),l("div",ke,[t("div",je,[t("h3",Ve,[i(o(v),{class:"h-5 w-5 mr-2 text-purple-600"}),e[16]||(e[16]=g(" Productions Récentes ",-1))])]),t("div",Se,[V.value.length===0?(a(),l("div",Ce,[i(o(v),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e[17]||(e[17]=t("p",{class:"text-gray-600"},"Aucune production récente",-1))])):(a(),l("div",Te,[(a(!0),l(M,null,B(V.value,n=>(a(),l("div",{key:n.id,class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[t("div",Pe,[t("div",Ae,[i(o(v),{class:"h-5 w-5 text-white"})]),t("div",null,[t("div",Ee,r(n.lot_id||`Lot-${n.id}`),1),t("div",$e,r(st(n.date)),1)])]),t("div",Me,[t("div",Be,r(n.quantite_ciment||0)+"kg ciment ",1),t("span",{class:F(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",P(n.statut)])},[(a(),N(R(A(n.statut)),{class:"h-3 w-3 mr-1"})),g(" "+r(E(n.statut)),1)],2)])]))),128))]))])])):u("",!0)]),t("div",Fe,[t("h3",Ne,[i(o($),{class:"h-5 w-5 mr-2 text-orange-600"}),e[18]||(e[18]=g(" Statistiques Avancées ",-1))]),t("div",Re,[o(d).canViewLivraisons?(a(),l("div",Ie,[t("div",qe,[i(o(I),{class:"h-8 w-8 text-white"})]),e[19]||(e[19]=t("h4",{class:"text-lg font-semibold text-gray-900"},"CA du Mois",-1)),t("p",ze,r(p(tt.value)),1)])):u("",!0),o(d).canViewLivraisons?(a(),l("div",Ge,[t("div",Oe,[i(o(D),{class:"h-8 w-8 text-white"})]),e[20]||(e[20]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Taux de Livraison",-1)),t("p",He,r(y.value>0?Math.round(S.value/y.value*100):0)+"% ",1)])):u("",!0),o(d).canViewProduction?(a(),l("div",Je,[t("div",Ke,[i(o(v),{class:"h-8 w-8 text-white"})]),e[21]||(e[21]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Taux de Production",-1)),t("p",Xe,r(b.value>0?Math.round(C.value/b.value*100):0)+"% ",1)])):u("",!0)])])])]))}}),Ze=mt(Ye,[["__scopeId","data-v-f126e4f1"]]);export{Ze as default};
