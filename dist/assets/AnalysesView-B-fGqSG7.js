import{c as m,b as t,o as f,d as S,J as C,K as $,r as R,h as V,C as q,G as L,i as P,s as p,t as i,e as O,x as Y,j as h,k as j,L as N,F,q as D}from"./index-DShiURXh.js";import{r as W}from"./PlusIcon-3nd0CGQo.js";import{r as A}from"./ArrowUpIcon-CgKOcxby.js";function X(y,r){return f(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 12h14"})])}const z=S({__name:"LineChart",props:{data:{},labels:{},datasets:{},height:{default:300}},setup(y){C.register(...$);const r=y,u=R();let n=null;const a=()=>{if(!u.value)return;const o=u.value.getContext("2d");o&&(n&&n.destroy(),n=new C(o,{type:"line",data:{labels:r.labels,datasets:r.datasets},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0,grid:{color:"#f3f4f6"}},x:{grid:{color:"#f3f4f6"}}}}}))};return V(()=>{a()}),q(()=>r.data,()=>{a()},{deep:!0}),(o,e)=>(f(),m("div",{class:"w-full",style:L({height:`${o.height}px`})},[t("canvas",{ref_key:"canvasRef",ref:u},null,512)],4))}}),E=S({__name:"PieChart",props:{data:{},height:{default:300}},setup(y){C.register(...$);const r=y,u=R();let n=null;const a=()=>{if(!u.value)return;const o=u.value.getContext("2d");o&&(n&&n.destroy(),n=new C(o,{type:"pie",data:{labels:r.data.map(e=>e.label),datasets:[{data:r.data.map(e=>e.value),backgroundColor:r.data.map(e=>e.color),borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right"},tooltip:{callbacks:{label:function(e){const s=e.label||"",l=e.parsed,g=e.dataset.data.reduce((b,k)=>b+k,0),w=(l/g*100).toFixed(1);return`${s}: ${l.toLocaleString("fr-FR",{style:"currency",currency:"XOF"})} (${w}%)`}}}}}}))};return V(()=>{a()}),q(()=>r.data,()=>{a()},{deep:!0}),(o,e)=>(f(),m("div",{class:"w-full",style:L({height:`${o.height}px`})},[t("canvas",{ref_key:"canvasRef",ref:u},null,512)],4))}}),J={class:"space-y-6"},T={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},G={class:"bg-white rounded-2xl shadow-md p-6 border border-gray-100"},K={class:"flex items-center justify-between"},Z={class:"text-2xl font-bold text-gray-900"},H={class:"flex items-center space-x-2"},I={class:"h-12 w-12 rounded-xl bg-orange-100 flex items-center justify-center"},Q={class:"bg-white rounded-2xl shadow-md p-6 border border-gray-100"},U={class:"flex items-center justify-between"},tt={class:"text-2xl font-bold text-gray-900"},et={class:"h-12 w-12 rounded-xl bg-blue-100 flex items-center justify-center"},st={class:"bg-white rounded-2xl shadow-md p-6 border border-gray-100"},ot={class:"flex items-center justify-between"},rt={class:"text-2xl font-bold text-gray-900"},at={class:"h-12 w-12 rounded-xl bg-green-100 flex items-center justify-center"},nt={class:"bg-white rounded-2xl shadow-md p-6 border border-gray-100"},lt={class:"flex items-center justify-between"},it={class:"text-2xl font-bold text-gray-900"},dt={class:"h-12 w-12 rounded-xl bg-purple-100 flex items-center justify-center"},ct={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ut={class:"bg-white rounded-2xl shadow-md p-6 border border-gray-100"},gt={class:"bg-white rounded-2xl shadow-md p-6 border border-gray-100"},pt={class:"bg-white rounded-2xl shadow-md p-6 border border-gray-100"},mt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ft={class:"space-y-4"},xt={class:"flex items-center"},bt={class:"font-medium text-gray-900"},ht={class:"font-semibold text-gray-900"},vt={class:"bg-white rounded-2xl shadow-md border border-gray-100 overflow-hidden"},yt={class:"overflow-x-auto"},_t={class:"min-w-full divide-y divide-gray-200"},wt={class:"bg-white divide-y divide-gray-200"},kt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},jt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Mt={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800"},Ft=S({__name:"AnalysesView",setup(y){const r=P(()=>{const e=p.getStock().filter(l=>l.actif),s=[];for(let l=5;l>=0;l--){const g=new Date;g.setMonth(g.getMonth()-l);const b={mois:g.toLocaleDateString("fr-FR",{month:"short"}),production:0,livraisons:0};e.forEach(v=>{const x=p.getStatistiquesProductionArticle(v.id,"mois");b.production+=x.totalProduit});const M=p.getCommandes().filter(v=>{const x=new Date(v.date);return x.getMonth()===g.getMonth()&&x.getFullYear()===g.getFullYear()}).length;b.livraisons=M,s.push(b)}return s}),u=P(()=>{const o=p.getStock(),e=["#f97316","#3b82f6","#10b981","#8b5cf6","#ef4444","#06b6d4"];return o.map((s,l)=>({label:s.nom,value:s.stock*s.prix,color:e[l%e.length]}))}),n=R([{jour:"Lun",production:1200,objectif:1e3},{jour:"Mar",production:1350,objectif:1e3},{jour:"Mer",production:1100,objectif:1e3},{jour:"Jeu",production:1400,objectif:1e3},{jour:"Ven",production:1300,objectif:1e3},{jour:"Sam",production:800,objectif:600},{jour:"Dim",production:600,objectif:600}]),a=P(()=>{const o=p.getStock(),e=o.filter(d=>d.actif),s=e.reduce((d,c)=>{const _=p.getStatistiquesProductionArticle(c.id,"mois");return d+_.totalProduit},0),l=o.reduce((d,c)=>d+c.stock*c.prix,0),g=e.length>0?e.reduce((d,c)=>{const _=p.getStatistiquesProductionArticle(c.id,"mois");return d+_.rendementMoyen},0)/e.length:0,w=p.getCommandes(),b=new Date().getMonth(),k=new Date().getFullYear(),M=w.filter(d=>{const c=new Date(d.date);return c.getMonth()===b&&c.getFullYear()===k}).length,v=new Date;v.setMonth(v.getMonth()-1);const x=e.reduce((d,c)=>{const _=p.getStatistiquesProductionArticle(c.id,"mois");return d+_.totalProduit},0),B=x>0?(s-x)/x*100:0;return{productionMensuelle:s,evolutionProduction:Math.round(B*100)/100,livraisonsMensuelles:M,evolutionLivraisons:0,valeurStock:l,evolutionStock:0,tauxRendement:Math.round(g*100)/100,evolutionRendement:0}});return(o,e)=>(f(),m("div",J,[e[13]||(e[13]=t("div",{class:"mb-8"},[t("h2",{class:"text-2xl font-bold text-gray-900"},"Analyses & Rapports"),t("p",{class:"mt-2 text-gray-600"},"Tableaux de bord et analyses détaillées")],-1)),t("div",T,[t("div",G,[t("div",K,[t("div",null,[e[1]||(e[1]=t("p",{class:"text-sm font-medium text-gray-600"},"Production mensuelle",-1)),t("p",Z,i(a.value.productionMensuelle.toLocaleString()),1),t("div",H,[e[0]||(e[0]=t("span",{class:"text-sm text-gray-500"},"articles",-1)),a.value.evolutionProduction!==0?(f(),m("span",{key:0,class:Y([a.value.evolutionProduction>0?"text-green-600":"text-red-600","text-xs font-medium"])},i(a.value.evolutionProduction>0?"+":"")+i(a.value.evolutionProduction)+"% ",3)):O("",!0)])]),t("div",I,[h(j(W),{class:"h-6 w-6 text-orange-600"})])])]),t("div",Q,[t("div",U,[t("div",null,[e[2]||(e[2]=t("p",{class:"text-sm font-medium text-gray-600"},"Livraisons mensuelles",-1)),t("p",tt,i(a.value.livraisonsMensuelles),1),e[3]||(e[3]=t("p",{class:"text-sm text-gray-500"},"commandes",-1))]),t("div",et,[h(j(A),{class:"h-6 w-6 text-blue-600"})])])]),t("div",st,[t("div",ot,[t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm font-medium text-gray-600"},"Valeur stock",-1)),t("p",rt,i(a.value.valeurStock.toLocaleString("fr-FR",{style:"currency",currency:"XOF"})),1),e[5]||(e[5]=t("p",{class:"text-sm text-gray-500"},"total",-1))]),t("div",at,[h(j(X),{class:"h-6 w-6 text-green-600"})])])]),t("div",nt,[t("div",lt,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-gray-600"},"Taux de rendement",-1)),t("p",it,i(a.value.tauxRendement)+"%",1),e[7]||(e[7]=t("p",{class:"text-sm text-gray-500"},"moyen",-1))]),t("div",dt,[h(j(A),{class:"h-6 w-6 text-purple-600"})])])])]),t("div",ct,[t("div",ut,[e[8]||(e[8]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-6"},"Évolution production mensuelle",-1)),h(N,{data:r.value,labels:r.value.map(s=>s.mois),datasets:[{label:"Production totale",data:r.value.map(s=>s.production),backgroundColor:"#f97316"},{label:"Livraisons",data:r.value.map(s=>s.livraisons),backgroundColor:"#3b82f6"}],height:256},null,8,["data","labels","datasets"])]),t("div",gt,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-6"},"Performance hebdomadaire",-1)),h(z,{data:n.value,labels:n.value.map(s=>s.jour),datasets:[{label:"Production",data:n.value.map(s=>s.production),borderColor:"#f97316",backgroundColor:"rgba(249, 115, 22, 0.1)",borderWidth:3,fill:!0},{label:"Objectif",data:n.value.map(s=>s.objectif),borderColor:"#6b7280",backgroundColor:"rgba(107, 114, 128, 0.1)",borderWidth:2,fill:!1}],height:256},null,8,["data","labels","datasets"])])]),t("div",pt,[e[10]||(e[10]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-6"},"Répartition de la valeur stock",-1)),t("div",mt,[h(E,{data:u.value,height:256},null,8,["data"]),t("div",ft,[(f(!0),m(F,null,D(u.value,s=>(f(),m("div",{key:s.label,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",xt,[t("div",{class:"w-4 h-4 rounded-full mr-3",style:L({backgroundColor:s.color})},null,4),t("span",bt,i(s.label),1)]),t("span",ht,i(s.value.toLocaleString("fr-FR",{style:"currency",currency:"XOF"})),1)]))),128))])])]),t("div",vt,[e[12]||(e[12]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Récapitulatif mensuel")],-1)),t("div",yt,[t("table",_t,[e[11]||(e[11]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Mois"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Production totale"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Livraisons"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Rendement")])],-1)),t("tbody",wt,[(f(!0),m(F,null,D(r.value,s=>(f(),m("tr",{key:s.mois,class:"hover:bg-gray-50"},[t("td",kt,i(s.mois),1),t("td",jt,i(s.production.toLocaleString()),1),t("td",Ct,i(s.livraisons),1),t("td",Mt,[t("span",Pt,i(s.production>0?Math.round(s.production/1e3*100)/100:0)+"% ",1)])]))),128))])])])])]))}});export{Ft as default};
